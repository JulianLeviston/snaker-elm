---
phase: 01-backend-modernization
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - .mise.toml
autonomous: true

must_haves:
  truths:
    - "Developer can activate mise environment with single command"
    - "Elixir version is 1.15+"
    - "Erlang/OTP version is 26+"
    - "Node version is 20+"
  artifacts:
    - path: ".mise.toml"
      provides: "Version pins for Elixir, Erlang, Node"
      contains: "elixir"
  key_links: []
---

<objective>
Set up mise environment management with version pins for the upgraded Elixir/Erlang/Node stack.

Purpose: Establish reproducible development environment before upgrading Phoenix dependencies. This ensures all subsequent work uses correct runtime versions.
Output: `.mise.toml` file with version pins; verified mise activation.
</objective>

<execution_context>
@/Users/julian/.claude/get-shit-done/workflows/execute-plan.md
@/Users/julian/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md
@.planning/phases/01-backend-modernization/01-RESEARCH.md
@.planning/phases/01-backend-modernization/01-CONTEXT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create mise configuration</name>
  <files>.mise.toml</files>
  <action>
Create `.mise.toml` in project root with version pins:

```toml
[tools]
elixir = "1.15"
erlang = "26"
node = "20"
```

Use minor version ranges (not patch-specific) per CONTEXT.md decision. This allows 1.15.x, 26.x, 20.x while ensuring minimum compatibility.
  </action>
  <verify>
1. `cat .mise.toml` shows expected content
2. File has correct TOML syntax (mise will fail if invalid)
  </verify>
  <done>`.mise.toml` exists with Elixir 1.15, Erlang 26, Node 20 pins</done>
</task>

<task type="auto">
  <name>Task 2: Verify mise activation</name>
  <files></files>
  <action>
Install required versions and verify mise environment:

1. Run `mise install` to install pinned versions (if not already installed)
2. Run `mise trust` to trust the config file
3. Verify versions with:
   - `mise exec -- elixir --version` (should show 1.15.x)
   - `mise exec -- erl -eval 'erlang:display(erlang:system_info(otp_release)), halt().' -noshell` (should show 26)
   - `mise exec -- node --version` (should show v20.x)

Note: `mise exec --` runs command in the mise environment even if shell hook not active.

If mise is not installed on the system, log the installation command (`brew install mise` on macOS) and note it as a prerequisite. The plan can still complete with `.mise.toml` created.
  </action>
  <verify>
1. `mise exec -- elixir --version` outputs Elixir 1.15.x
2. `mise exec -- node --version` outputs v20.x
3. (Or) If mise not installed: note prerequisite, verify .mise.toml file is valid
  </verify>
  <done>mise environment activates with correct Elixir 1.15+, Erlang 26+, Node 20+</done>
</task>

</tasks>

<verification>
Run these commands to verify phase completion:

```bash
# Verify .mise.toml exists and has correct content
cat .mise.toml | grep -E "elixir|erlang|node"

# Verify mise can parse the config
mise ls --current 2>/dev/null || echo "mise not installed"

# Verify versions (if mise installed)
mise exec -- elixir --version
mise exec -- node --version
```

All version outputs should match pins (1.15.x, 26, 20.x).
</verification>

<success_criteria>
1. `.mise.toml` exists in project root
2. File contains version pins for elixir (1.15), erlang (26), node (20)
3. `mise exec -- elixir --version` shows 1.15.x (or mise installation noted as prerequisite)
4. Environment is reproducible for future sessions
</success_criteria>

<output>
After completion, create `.planning/phases/01-backend-modernization/01-01-SUMMARY.md`
</output>
